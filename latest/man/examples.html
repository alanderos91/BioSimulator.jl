<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · BioSimulator.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/default.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Ubuntu+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../../versions.js"></script></head><body><nav class="toc"><h1>BioSimulator.jl</h1><form class="search" action="../search.html"><select id="version-selector" onChange="window.location.href=this.value"><option value="#" selected="selected" disabled="disabled">Version</option></select><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><a class="toctext" href="overview.html">Overview</a></li><li><a class="toctext" href="modeling.html">Modeling</a></li><li><a class="toctext" href="algorithms.html">Algorithms</a></li><li class="current"><a class="toctext" href="examples.html">Examples</a><ul class="internal"><li><a class="toctext" href="#Birth-Death-Immigration-Process-1">Birth-Death-Immigration Process</a></li><li><a class="toctext" href="#Enzyme-Kinetics-1">Enzyme Kinetics</a></li><li><a class="toctext" href="#Auto-Regulatory-Gene-Network-1">Auto-Regulatory Gene Network</a></li><li><a class="toctext" href="#Brusselator-Cascade-1">Brusselator Cascade</a></li></ul></li><li><a class="toctext" href="benchmarks.html">Benchmarks</a></li><li><a class="toctext" href="developers.html">Developers</a></li><li><a class="toctext" href="references.html">References</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="examples.html">Examples</a></li></ul><a class="edit-page" href="https://github.com/alanderos91/BioSimulator.jl/tree/67e753ab565f1fc95535967de7f688c9be37566f/docs/src/man/examples.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/></header><h1><a class="nav-anchor" id="Examples-1" href="#Examples-1">Examples</a></h1><h2><a class="nav-anchor" id="Birth-Death-Immigration-Process-1" href="#Birth-Death-Immigration-Process-1">Birth-Death-Immigration Process</a></h2><div></div><p><em>Kendall&#39;s process</em> is a birth-death-immigration process describing the dynamics of a population using a continuous-time Markov chain. Individuals in the population behave as particles that reproduce at a rate <span>$\alpha$</span>, decay at a rate <span>$\mu$</span>, and immigrate into the population at a rate <span>$\nu$</span>.</p><pre><code class="language-">  model = Network(&quot;Kendall&#39;s Process&quot;)

  model &lt;= Species(&quot;X&quot;, 5)

  model &lt;= Reaction(&quot;birth&quot;, 2.0, &quot;X --&gt; X + X&quot;)
  model &lt;= Reaction(&quot;death&quot;, 1.0, &quot;X --&gt; 0&quot;)
  model &lt;= Reaction(&quot;immigration&quot;, 0.5, &quot;0 --&gt; X&quot;)

  fig = visualize(model)
  using TikzPictures; save(SVG(&quot;kendallfig&quot;), fig) # hide</code></pre><p><img src="kendallfig.svg" alt/></p><div><pre><code class="language-julia">  result = simulate(model, algorithm=SSA, time=4.0, epochs=40, trials=1000)

  plot(
    plot(MeanTrajectory(result, &quot;X&quot;)),
    plot(Histogram(result, &quot;X&quot;, 4.0)),
    layout = 2,
    size = (600,300)
  )</code></pre><pre><code class="language-none">WARNING: No working GUI backend found for matplotlib
sys:1: MatplotlibDeprecationWarning: The set_axis_bgcolor function was deprecated in version 2.0. Use set_facecolor instead.</code></pre></div><p><img src="kendall.svg" alt/></p><h2><a class="nav-anchor" id="Enzyme-Kinetics-1" href="#Enzyme-Kinetics-1">Enzyme Kinetics</a></h2><div></div><p>Michaelis-Menten enzyme kinetics is a stepwise process combining first- and second order reactions to describe the conversion of a substrate into a product. An enzyme <span>$E$</span> binds to a substrate <span>$S$</span> to form a complex <span>$SE$</span>. Conversion does not happen immediately, so <span>$SE$</span> may revert to its two components or result in a product <span>$P$</span> and enzyme <span>$E$</span>.</p><pre><code class="language-">  model = Network(&quot;enzyme kinetics&quot;)

  model &lt;= Species(&quot;S&quot;, 301)
  model &lt;= Species(&quot;E&quot;, 100)
  model &lt;= Species(&quot;SE&quot;,  0)
  model &lt;= Species(&quot;P&quot;,   0)

  model &lt;= Reaction(&quot;Binding&quot;, 0.00166, &quot;S + E --&gt; SE&quot;)
  model &lt;= Reaction(&quot;Dissociation&quot;, 0.0001, &quot;SE --&gt; S + E&quot;)
  model &lt;= Reaction(&quot;Conversion&quot;, 0.1, &quot;SE --&gt; P + E&quot;)

  fig = visualize(model)
  using TikzPictures; save(SVG(&quot;mmekfig&quot;), fig) # hide</code></pre><p><img src="mmekfig.svg" alt/></p><div><pre><code class="language-julia">  result = simulate(model, algorithm=SSA, time=50.0, epochs=100, trials=1000)

  plot(MeanTrajectory(result, &quot;S&quot;),  color=&quot;blue&quot;)
  plot!(MeanTrajectory(result, &quot;E&quot;),  color=&quot;green&quot;)
  plot!(MeanTrajectory(result, &quot;SE&quot;), color=&quot;orange&quot;)
  plot!(MeanTrajectory(result, &quot;P&quot;),  color=&quot;red&quot;)</code></pre></div><p><img src="mmek1.svg" alt/></p><div><pre><code class="language-julia">  plot(
    plot(Histogram(result, &quot;S&quot;,  50.0), label=&quot;S&quot;,  color=&quot;blue&quot;),
    plot(Histogram(result, &quot;E&quot;,  50.0), label=&quot;E&quot;,  color=&quot;green&quot;),
    plot(Histogram(result, &quot;SE&quot;, 50.0), label=&quot;SE&quot;, color=&quot;orange&quot;),
    plot(Histogram(result, &quot;P&quot;,  50.0), label=&quot;P&quot;,  color=&quot;red&quot;)
  )</code></pre></div><p><img src="mmek2.svg" alt/></p><h2><a class="nav-anchor" id="Auto-Regulatory-Gene-Network-1" href="#Auto-Regulatory-Gene-Network-1">Auto-Regulatory Gene Network</a></h2><div></div><p>The influence of noise at the cellular level is difficult to capture in deterministic models. Stochastic simulation is appropriate for the study of regulatory mechanisms in genetics, where key species may be present in low numbers.</p><pre><code class="language-">  function autoreg(;k1=1.0, k1r=10.0, k2=0.01, k3=10.0, k4=1.0, k4r=1.0, k5=0.1, k6=0.01)
    model = Network(&quot;auto-regulation&quot;)

    model &lt;= Species(&quot;gene&quot;,   10)
    model &lt;= Species(&quot;P2_gene&quot;, 0)
    model &lt;= Species(&quot;RNA&quot;,     0)
    model &lt;= Species(&quot;P&quot;,       0)
    model &lt;= Species(&quot;P2&quot;,      0)

    model &lt;= Reaction(&quot;repression binding&quot;, k1, &quot;gene + P2 --&gt; P2_gene&quot;)
    model &lt;= Reaction(&quot;reverse repression binding&quot;, k1r, &quot;P2_gene --&gt; gene + P2&quot;)
    model &lt;= Reaction(&quot;transcription&quot;, k2, &quot;gene --&gt; gene + RNA&quot;)
    model &lt;= Reaction(&quot;translation&quot;, k3, &quot;RNA --&gt; RNA + P&quot;)
    model &lt;= Reaction(&quot;dimerization&quot;, k4, &quot;P + P --&gt; P2&quot;)
    model &lt;= Reaction(&quot;dissociation&quot;, k4r, &quot;P2 --&gt; P + P&quot;)
    model &lt;= Reaction(&quot;RNA degradation&quot;, k5, &quot;RNA --&gt; 0&quot;)
    model &lt;= Reaction(&quot;protein degradation&quot;, k6, &quot;P --&gt; 0&quot;)

    return model
  end

  model = autoreg()

  fig = visualize(model)
  using TikzPictures; save(SVG(&quot;genefig&quot;), fig) # hide</code></pre><p><img src="genefig.svg" alt/></p><div><pre><code class="language-julia">  result = simulate(model, algorithm=SSA, time=1000.0, epochs=500, trials=100)

  plot(MeanTrajectory(result, &quot;P&quot;), color=&quot;blue&quot;)
  plot!(MeanTrajectory(result, &quot;P2&quot;), color=&quot;red&quot;)</code></pre></div><p><img src="gene1.svg" alt/></p><div><pre><code class="language-julia">  plot(
    plot(Histogram(result, &quot;P&quot;,  1000.0), color=&quot;blue&quot;),
    plot(Histogram(result, &quot;P2&quot;, 1000.0), color=&quot;red&quot;),
    size = (600,300)
  )</code></pre></div><p><img src="gene2.svg" alt/></p><h2><a class="nav-anchor" id="Brusselator-Cascade-1" href="#Brusselator-Cascade-1">Brusselator Cascade</a></h2><div></div><p>The Brusselator is a theoretical model used to study autocatalytic reactions. The reactions in the model are</p><blockquote><div>\[A \to X\]</div><div>\[2X + Y \to 3X\]</div><div>\[X + B \to Y + D\]</div><div>\[X \to E,\]</div></blockquote><p>where <span>$A$</span>, <span>$B$</span>, and <span>$D$</span> are chemical species assumed to be constant in concentration; only <span>$X$</span> and <span>$Y$</span> vary over time.. The species <span>$A$</span> and <span>$B$</span> act as inputs to the synthesis and conversion of <span>$X$</span>, whereas <span>$D$</span> and <span>$E$</span> are byproducts with no impact on the system. The <span>$Y$</span> species acts as a catalyst to the synthesis of <span>$X$</span> so that <span>$X$</span> is autocatalytic. Note that the last reaction can be thought of as the decay of <span>$X$</span>.</p><p>One can study the role of stochasticity in chemical reaction cascades by coupling Brusselators[<a href="man/references.html#16">16</a>]. A cascade with <span>$N$</span> steps is modeled as</p><blockquote><div>\[A \to X_{1}\]</div><div>\[2 X_{n} + Y_{n} \to 3 X_{n}; n = 1,\ldots,N\]</div><div>\[X_{n} + B \to Y_{n} + D; n = 1,\ldots,N\]</div><div>\[X_{n} \to X_{n+1}; n = 1,\ldots,N-1\]</div><div>\[X_{N} \to E,\]</div></blockquote><p>where the <span>$X_{n} \to X_{n+1}$</span> reactions effectively couple each Brusselator. The fixed point of the system is given by the concentrations of <span>$A$</span> and <span>$B$</span>: <span>$([X_{n}], [Y_{n}]) = ([A], [A] / [B])$</span> for each <span>$n = 1,\ldots,N$</span>, which is stable for <span>$[B] &lt; [A]^{2} + 1$</span> and unstable for <span>$[B] &gt; [A]^{2} + 1$</span>. A limit cycle exists in the unstable case which propagates noise down the steps in the cascade. A deterministic model predicts asymptotic stability at the end of the cascade, but small fluctuations from the fixed point are amplified in the stochastic setting.</p><p>This example walks through an implementation of the Brusselator cascade, including conversion of deterministic rates to stochastic rates.</p><div><pre><code class="language-julia">  model = Network(&quot;Brusselator&quot;)

  N = 20    # number of Brusselators
  V = 100.0 # system volume

  # ===== Deterministic Rates =====
  k1 = 1.0  # buffer rate
  k2 = 1.0  # transition/decay rate
  k3 = 1.0  # conversion rate
  k4 = 1.0  # autocatalytic rate

  # ===== Stochastic Rates =====
  # To model a constant buffer X0 we add a zero-order reaction (like immigration)
  # The stochastic rates have to take into account the system volume

  γ1 = k1                    # buffer rate
  γ2 = k2 / V                # transition/decay rate
  γ3 = k3 / V                # conversion rate
  γ4 = 2 * k4 / (V * V * V)  # autocatalytic rate

  for i = 1:N
      # species definitions
      model &lt;= Species(&quot;X$(i)&quot;, 0)
      model &lt;= Species(&quot;Y$(i)&quot;, 0)

      # autocatalytic reactions
      model &lt;= Reaction(&quot;conversion$(i)&quot;,    γ3, &quot;X$(i) --&gt; Y$(i)&quot;)
      model &lt;= Reaction(&quot;autocatalysis$(i)&quot;, γ4, &quot;X$(i) + X$(i) + Y$(i) --&gt; X$(i) + X$(i) + X$(i)&quot;)
  end

  for i = 2:N
      # cascades
      model &lt;= Reaction(&quot;cascade$(i)&quot;, γ2, &quot;X$(i-1) --&gt; X$(i)&quot;)
  end

  model &lt;= Reaction(&quot;buffer&quot;, γ1, &quot;0 --&gt; X1&quot;)
  model &lt;= Reaction(&quot;decay&quot;,  γ2, &quot;X$(N) --&gt; 0&quot;)</code></pre></div><p>The phase portrait of the system comparing <span>$X_{1}$</span> and <span>$Y_{1}$</span> against <span>$X_{N}$</span> and <span>$Y_{N}$</span> shows that noise at the first step is propagated to the final step in the cascade over time.</p><div><pre><code class="language-julia">  result = simulate(model, time=10_000.0, epochs=10_000)

  plot(
    plot(PhaseTrajectory(result, &quot;X1&quot;, &quot;Y1&quot;, 1)),
    plot(PhaseTrajectory(result, &quot;X$(N)&quot;, &quot;Y$(N)&quot;, 1)),
    size=(800,350)
  )</code></pre></div><p><img src="brusselator.svg" alt/></p><footer><hr/><a class="previous" href="algorithms.html"><span class="direction">Previous</span><span class="title">Algorithms</span></a><a class="next" href="benchmarks.html"><span class="direction">Next</span><span class="title">Benchmarks</span></a></footer></article></body></html>
